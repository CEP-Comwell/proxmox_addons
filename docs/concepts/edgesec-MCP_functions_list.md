| Priority | Category                     | Function Name                 | Description                                                                 | Tags                                   | MCP Relation                                             | Example (edgesec‑MCP)                                                                                 |
|---------:|------------------------------|-------------------------------|-----------------------------------------------------------------------------|----------------------------------------|----------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| 1        | Security & RBAC              | `authenticate_user_jwt()`     | Verify JWTs and attach identity to requests                                | #foundation #security                  | MCP session security & role-based context               | Verify JWT → write `tenant_id`, `roles` into MCP session context                                       |
| 2        | Security & RBAC              | `enforce_tenant_context()`    | Apply tenant scoping to all operations                                     | #foundation #security #tenant          | Context isolation & namespace partitioning              | Tenant `acme` isolates Proxmox/NetBox queries via tenant namespace                                     |
| 3        | Security & RBAC              | `authorize_action_rbac()`     | Enforce role-based access control                                          | #foundation #security                  | Role-based delegation in MCP                            | Role `ops` can `inventory:sync`; role `viewer` limited to `inventory:read`                             |
| 4        | Security & RBAC              | `log_audit_event()`           | Record security-relevant/admin actions                                      | #foundation #security #ops             | Persistent context & audit trails                        | Log `inventory.sync.proxmox` start/finish with jobId → persisted in MCP memory                         |
| 5        | Observability & Ops          | `health_check()`              | Provide liveness/readiness endpoints                                       | #foundation #observability             | Orchestration health signals                             | `/readyz` returns OK only if Vault token valid and Redis/DB reachable                                   |
| 6        | Observability & Ops          | `export_prometheus_metrics()` | Expose Prometheus metrics for monitoring                                   | #foundation #observability             | Feedback loop metrics                                    | Track Proxmox/Datto API latency, job durations, normalization errors                                    |
| 7        | Observability & Ops          | `trace_request_flow()`        | Trace request/operation lifecycle                                           | #foundation #observability             | Contextual trace for MCP                                  | Trace `sync-proxmox` across fetch → normalize → snapshot with correlation IDs                           |
| 8        | Integration & Extensibility  | `fetch_secret_from_vault()`   | Retrieve secrets from HashiCorp Vault (short‑lived tokens)                  | #foundation #vault #security           | Secure tool registration & discovery                     | AppRole login; read `kv/acme/proxmox/api_token` for Proxmox & `kv/acme/netbox/token` for NetBox         |
| 9        | API & Protocol Extensions    | `get_async_job_status()`      | Query background job status (queued/running/succeeded/failed)              | #foundation #async #observability      | Event‑driven orchestration state                          | UI polls `/jobs/:id` for `sync:datto` to show progress and error logs                                   |
| 10       | Inventory & Source Sync      | `sync_inventory_proxmox()`    | Gather VM/container/host metadata from Proxmox VE                          | #inventory #proxmox #async             | Dynamic tool integration & schema ingestion               | Proxmox: GET `/api2/json/cluster/resources?type=vm` → normalize into inventory                          |
| 11       | Inventory & Source Sync      | `normalize_inventory_data()`  | Harmonize raw payloads into a validated normalized model                   | #inventory #foundation                 | Adaptive schema evolution & model updates                | Map `vmid,node,status` (Proxmox) + `device/name` (NetBox) into unified `attrs`                          |
| 12       | Inventory & Source Sync      | `cache_inventory_snapshot()`  | Create point‑in‑time snapshots of normalized inventory                     | #inventory                             | Persistent state for MCP memory                          | Snapshot inventory JSONB; compute diffs; post summary to Teams                                          |
| 13       | Inventory & Source Sync      | `sync_inventory_netbox()`     | Ingest devices/interfaces/IPs from NetBox                                  | #inventory #netbox #async              | Multi‑source orchestration & schema adaptation           | NetBox: GET `/api/dcim/devices?limit=...`; GET `/api/ipam/ip-addresses?...` for IPAM enrichment        |
| 14       | Inventory & Source Sync      | `sync_inventory_datto_rmm()`  | Pull asset/device data from Datto RMM (with pagination/backoff)            | #inventory #datto #async               | Automated API consumption & schema diff detection        | Datto RMM: GET `/devices`, GET `/devices/{id}/audit`; backoff on 429; merge tags/fields                 |
| 15       | API & Protocol Extensions    | `trigger_event_hook()`        | Emit hooks on system events (sync complete, errors, snapshots)             | #foundation #extensibility #async      | Event‑driven feedback for MCP                            | Emit `inventory.synced` → triggers reconcile workflow or Ansible stage                                  |
| 16       | Integration & Extensibility  | `send_notification()`         | Send alerts (Teams/email) on job results or incidents                      | #ops #extensibility                    | Feedback injection into context                          | Teams card: “Proxmox sync completed: 120 assets, 3 diffs; see job logs”                                 |
| 17       | Orchestration & Automation   | `run_ansible_playbook()`      | Execute Ansible playbooks with tenant context & Vault secrets              | #orchestration #vault #async           | Context‑aware orchestration & tool chaining              | Post‑sync: run `netbird_peer.yml` against hosts labeled `edge` based on NetBox diff                     |
| 18       | Orchestration & Automation   | `execute_workflow_pipeline()` | Run multi‑step pipelines (fetch→normalize→snapshot→notify→orchestrate)     | #orchestration #async                  | MCP‑driven orchestration & state machine                 | Pipeline: `datto→normalize→netbox_reconcile→teams_notify`                                               |
| 19       | Orchestration & Automation   | `rollback_last_operation()`   | Revert last change/deployment using operation metadata                      | #orchestration #ops                    | Branching & checkpointing in context                     | Revert NetBox device role updates if post‑checks fail                                                    |
| 20       | Orchestration & Automation   | `handle_orchestration_error()`| Centralize error capture/correlation/recovery                              | #orchestration #ops #observability     | Feedback‑driven error handling                           | On Proxmox 5xx, open incident, mark job failed, emit `orchestration.error`, notify Teams                |
| 21       | Data Model & Context Mgmt    | `validate_context_schema()`   | Meta‑validate proposed context/normalized JSON Schemas                     | #foundation #inventory                 | Automated schema validation & compliance                 | Validate new `inventory.normalized.v1` extension adding `ipv6[]`                                        |
| 22       | Data Model & Context Mgmt    | `version_context_model()`     | Track & activate versions of the context/normalized model per tenant       | #foundation #inventory #tenant         | Schema versioning & compatibility                        | Promote `v2` model; store migration map; tag snapshots by model version                                  |
| 23       | Data Model & Context Mgmt    | `extend_context_model()`      | Add domain‑specific extensions to the normalized model with guardrails     | #foundation #inventory #extensibility  | Dynamic context extension                                | Add `netbirdPeerId` and `pveNodeZpool` attributes for edge operations                                    |
| 24       | API & Protocol Extensions    | `register_custom_endpoint()`  | Dynamically add new REST endpoints (extensions)                            | #extensibility #foundation             | Dynamic tool registration & capability negotiation       | Register `/ext/netbird/sync` endpoint provided by plugin                                                 |
| 25       | Integration & Extensibility  | `load_plugin()`               | Load external plugin modules at startup/runtime                            | #extensibility                         | Dynamic discovery & composability                        | Load `netbird`, `edgesec‑traffic‑mirror` plugins from `plugins/`                                         |
| 26       | Integration & Extensibility  | `call_external_api()`         | Hardened outbound HTTP (retries, jitter, timeouts, circuit breaker)        | #foundation #extensibility             | Reliable API consumption                                 | Wrap Datto/NetBox calls with retry & circuit‑breaker; emit metrics                                       |
| 27       | Observability & Ops          | `log_system_event()`          | Record operational events (deploys, migrations, throttling)                | #ops #observability                    | Persistent feedback for learning loops                   | Log “Vault token renewed”, “Queue paused due to rate limit”, with correlation IDs                        |
| 28       | Observability & Ops          | `render_admin_dashboard()`    | Admin UI for health, metrics, jobs, inventory counts, audits               | #ui #ops                               | Visualization of MCP state & orchestration health        | Dashboard shows Proxmox/Datto sync status, NetBox diffs, pipeline runs                                    |
| 29       | DevOps & CI/CD               | `build_docker_image()`        | Build reproducible service container images                                | #cicd #ops                             | Module packaging for MCP services                         | Build `ghcr.io/…/mcp-api:<sha>`; pin Node 20 base                                                         |
| 30       | DevOps & CI/CD               | `execute_integration_tests()` | Run integration/E2E test suites (compose/mocked externals)                 | #cicd #ops                             | Continuous testing w/ feedback                           | Bring up `postgres+redis+vault` in compose; test `sync_inventory_proxmox` & normalization paths           |
| 31       | DevOps & CI/CD               | `run_ci_pipeline()`           | Orchestrate CI (lint, typecheck, tests, scans)                             | #cicd                                  | Continuous integration for MCP modules                   | GitHub Actions: lint→typecheck→tests→build; push images on `main`                                         |
| 32       | DevOps & CI/CD               | `deploy_service_stack()`      | Deploy via Compose/Kubernetes with environment‑scoped config               | #cicd #ops                             | MCP‑aware deployment orchestration                       | Staging deploy: compose or Helm; readiness tied to Vault/DB/Redis health                                  |

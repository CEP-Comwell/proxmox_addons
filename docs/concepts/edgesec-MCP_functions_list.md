| Priority | Category                     | Function Name                   | Description                                                               | Tags                               | Tech (Implements)                 | Caller Stack (Utilizes)                                  | Business Function  | Org Role           | MCP Relation                                         | Example (edgesec‑MCP)                                                                          |
|---------:|------------------------------|----------------------------------|---------------------------------------------------------------------------|------------------------------------|-----------------------------------|---------------------------------------------------------|--------------------|--------------------|------------------------------------------------------|------------------------------------------------------------------------------------------------|
| 1        | Security & RBAC              | `authenticate_user_jwt()`       | Verify JWTs and attach identity to requests                               | #foundation #security              | fastify, typescript, nodejs       | ui-nextjs, cli-curl                                     | security           | platform-engineer  | Session security & role-based context               | Verify JWT → persist `tenant_id`, `roles` in MCP session                                      |
| 2        | Security & RBAC              | `enforce_tenant_context()`      | Apply tenant scoping to all operations                                    | #foundation #security #tenant      | fastify, typescript               | ui-nextjs, worker-queue                                  | security           | platform-engineer  | Context isolation & namespaces                        | Tenant `acme` scopes all Proxmox/NetBox queries                                               |
| 3        | Security & RBAC              | `authorize_action_rbac()`       | Enforce role-based access control                                         | #foundation #security              | fastify, typescript               | ui-nextjs, cli-curl, worker-queue                        | security           | platform-engineer  | Role-based delegation in MCP                          | `ops` can `inventory:sync`; `viewer` only `inventory:read`                                     |
| 4        | Security & RBAC              | `log_audit_event()`             | Record security/admin actions                                             | #foundation #security #ops         | fastify, postgres                 | ui-nextjs, worker-queue                                  | security           | security-analyst   | Persistent audit trail                                | Log `inventory.sync.proxmox` start/finish with jobId                                          |
| 5        | Observability & Ops          | `health_check()`                | Liveness/readiness endpoints                                              | #foundation #observability         | fastify                           | github-actions, k8s/readiness, cli-curl                  | observability      | devops             | Orchestration health signals                          | `/readyz` OK only if DB, Redis, Vault reachable                                              |
| 6        | Observability & Ops          | `export_prometheus_metrics()`   | Expose Prometheus metrics                                                 | #foundation #observability         | prometheus, fastify               | prometheus-scrape                                        | observability      | devops             | Feedback loop metrics                                 | Track Datto/Proxmox API latency, job durations                                               |
| 7        | Observability & Ops          | `trace_request_flow()`          | Trace request/operation lifecycle                                         | #foundation #observability         | opentelemetry, fastify            | ui-nextjs, worker-queue                                  | observability      | devops             | Contextual tracing                                    | Correlate `sync-proxmox` fetch→normalize→snapshot                                             |
| 8        | Integration & Extensibility  | `fetch_secret_from_vault()`     | Retrieve secrets from Vault (short‑lived tokens)                          | #foundation #vault #security       | vault, nodejs                     | worker-queue, ui-nextjs                                   | security           | platform-engineer  | Secure tool registration                              | AppRole login; read `kv/acme/proxmox/api_token`                                               |
| 9        | API & Protocol Extensions    | `get_async_job_status()`        | Query background job status                                               | #foundation #async #observability  | bullmq, redis, fastify            | ui-nextjs, cli-curl                                      | observability      | devops             | Orchestrated state visibility                          | UI polls `/jobs/:id` for `sync:datto`                                                         |
| 10       | Inventory & Source Sync      | `sync_inventory_proxmox()`      | Gather VM/container/host metadata from Proxmox VE                         | #inventory #proxmox #async         | nodejs, bullmq, redis             | worker-queue, external-proxmox                           | inventory-sync     | network-engineer   | Dynamic tool integration & ingestion                  | Proxmox GET `/api2/json/cluster/resources?type=vm`                                            |
| 11       | Inventory & Source Sync      | `normalize_inventory_data()`    | Harmonize raw payloads into normalized model                              | #inventory #foundation             | typescript, nodejs                | worker-queue                                              | inventory-sync     | platform-engineer  | Adaptive schema evolution                              | Map Proxmox `vmid,node,status` + NetBox `device/name` → unified attrs                         |
| 12       | Inventory & Source Sync      | `cache_inventory_snapshot()`    | Create point‑in‑time snapshots of normalized inventory                    | #inventory                         | postgres, nodejs                  | worker-queue                                              | inventory-sync     | infra-admin        | Persistent state for MCP                              | Store snapshot JSONB; compute diffs; notify Teams                                             |
| 13       | Inventory & Source Sync      | `sync_inventory_netbox()`       | Ingest devices/interfaces/IPs from NetBox                                 | #inventory #netbox #async          | nodejs, bullmq                    | worker-queue, external-netbox                            | inventory-sync     | network-engineer   | Multi‑source orchestration                            | NetBox GET `/api/dcim/devices?limit=…`, `/api/ipam/ip-addresses?...`                           |
| 14       | Inventory & Source Sync      | `sync_inventory_datto_rmm()`    | Pull asset/device data from Datto RMM (pagination/backoff)                | #inventory #datto #async           | nodejs, bullmq                    | worker-queue, external-datto                             | inventory-sync     | infra-admin        | Automated API consumption                              | Datto RMM GET `/devices`, `/devices/{id}/audit`; retry on 429                                 |
| 15       | API & Protocol Extensions    | `trigger_event_hook()`          | Emit hooks on system events                                               | #foundation #extensibility #async  | nodejs                           | worker-queue, ui-nextjs                                   | extensibility      | platform-engineer  | Event‑driven feedback                                  | Emit `inventory.synced` → pipeline continues                                                  |
| 16       | Integration & Extensibility  | `send_notification()`           | Send alerts (Teams/email)                                                 | #ops #extensibility                | nodejs                            | teams-webhook, ui-nextjs                                  | observability      | security-analyst   | Feedback injection                                     | Teams card: “Proxmox sync completed: 120 assets, 3 diffs”                                      |
| 17       | Orchestration & Automation   | `run_ansible_playbook()`        | Execute Ansible playbooks with tenant context & Vault secrets             | #orchestration #vault #async       | ansible, nodejs                    | ansible-semaphore, worker-queue                          | orchestration      | infra-admin        | Context‑aware orchestration                            | Run `netbird_peer.yml` on hosts labeled `edge`                                                |
| 18       | Orchestration & Automation   | `execute_workflow_pipeline()`   | Run multi‑step pipelines (fetch→normalize→notify→orchestrate)             | #orchestration #async              | nodejs, bullmq                    | ui-nextjs, worker-queue                                  | orchestration      | platform-engineer  | MCP‑driven orchestration                               | Pipeline `datto→normalize→netbox_reconcile→teams_notify`                                      |
| 19       | Orchestration & Automation   | `rollback_last_operation()`     | Revert last change/deployment using operation metadata                    | #orchestration #ops                | nodejs, postgres                  | ui-nextjs, worker-queue                                  | orchestration      | infra-admin        | Branching & checkpoints                                 | Revert NetBox role updates if post‑checks fail                                                |
| 20       | Orchestration & Automation   | `handle_orchestration_error()`  | Centralize error capture/correlation/recovery                             | #orchestration #ops #observability | nodejs, bullmq, opentelemetry     | worker-queue, teams-webhook                               | orchestration      | devops             | Feedback‑driven error handling                         | On Proxmox 5xx → mark failed, emit `orchestration.error`, notify Teams                         |
| 21       | Data Model & Context Mgmt    | `validate_context_schema()`     | Meta‑validate proposed JSON Schemas                                       | #foundation #inventory             | typescript, nodejs                | ui-nextjs, cli-curl                                       | inventory-sync     | platform-engineer  | Automated schema validation                            | Validate `inventory.normalized.v2` adding `ipv6[]`                                           |
| 22       | Data Model & Context Mgmt    | `version_context_model()`       | Track & activate versions of the model per tenant                         | #foundation #inventory #tenant     | postgres, nodejs                  | ui-nextjs                                                 | inventory-sync     | platform-engineer  | Versioning & compatibility                             | Promote v2, keep migration map, tag snapshots by version                                      |
| 23       | Data Model & Context Mgmt    | `extend_context_model()`        | Add domain‑specific extensions with guardrails                            | #foundation #inventory #extensibility | typescript, nodejs             | ui-nextjs                                                 | inventory-sync     | platform-engineer  | Dynamic context extension                               | Add `netbirdPeerId`, `pveNodeZpool` attributes                                               |
| 24       | API & Protocol Extensions    | `register_custom_endpoint()`    | Dynamically add new REST endpoints (extensions)                           | #extensibility #foundation         | fastify, nodejs                   | ui-nextjs, cli-curl                                       | extensibility      | platform-engineer  | Capability negotiation                                  | Register `/ext/netbird/sync` endpoint                                                         |
| 25       | Integration & Extensibility  | `load_plugin()`                 | Load external plugin modules at startup/runtime                           | #extensibility                     | nodejs                            | ui-nextjs                                                 | extensibility      | platform-engineer  | Dynamic discovery & composability                      | Load `netbird`, `edgesec-traffic-mirror` plugins                                              |
| 26       | Integration & Extensibility  | `call_external_api()`           | Hardened outbound HTTP (retries, jitter, timeouts, circuit breaker)       | #foundation #extensibility         | nodejs                            | worker-queue                                              | extensibility      | platform-engineer  | Reliable API consumption                                 | Wrap Datto/NetBox calls; emit metrics & errors                                               |
| 27       | Observability & Ops          | `log_system_event()`            | Record operational events (deploys, migrations, throttling)               | #ops #observability                 | nodejs, postgres                  | ui-nextjs                                                 | observability      | devops             | Persistent feedback                                     | “Vault token renewed”, “Queue paused due to rate limit”                                       |
| 28       | Observability & Ops          | `render_admin_dashboard()`      | Admin UI for health, metrics, jobs, inventory, audits                     | #ui #ops                            | nextjs, nodejs, prometheus        | ui-nextjs                                                 | observability      | infra-admin        | Visualization of MCP state                              | Dashboard shows Proxmox/Datto sync status, NetBox diffs                                       |
| 29       | DevOps & CI/CD               | `build_docker_image()`          | Build reproducible service container images                               | #cicd #ops                          | docker, nodejs                     | github-actions                                            | ci-cd              | devops             | MCP module packaging                                    | Build `ghcr.io/.../mcp-api:<sha>`; pin Node 20                                               |
| 30       | DevOps & CI/CD               | `execute_integration_tests()`   | Run integration/E2E suites (compose/mocked externals)                     | #cicd #ops                          | docker, nodejs                     | github-actions                                            | ci-cd              | devops             | Continuous testing with feedback                        | Spin up `postgres+redis+vault`; test `sync_inventory_proxmox`                                 |
| 31       | DevOps & CI/CD               | `run_ci_pipeline()`             | Orchestrate CI (lint, typecheck, tests, scans)                            | #cicd                               | github-actions, nodejs             | github-actions                                            | ci-cd              | devops             | Continuous integration                                  | Lint→typecheck→tests→build                                                                    |
| 32       | DevOps & CI/CD               | `deploy_service_stack()`        | Deploy via Compose/Kubernetes with env‑scoped config                      | #cicd #ops                          | docker, nodejs                     | github-actions                                            | ci-cd              | devops             | MCP‑aware deployment orchestration                      | Staging deploy; readiness gated on Vault/DB/Redis                                            |
